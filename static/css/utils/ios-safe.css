/**
 * iOS Safari & Accessibility Safe CSS Utilities
 * 
 * Цей файл містить CSS утиліти та обмеження для всіх 8 правил iOS Safari та доступності.
 * Імпортуйте його в основний CSS файл.
 * 
 * Це забезпечує:
 * 1. Безпечне sticky позиціонування (замість fixed)
 * 2. safe-area-inset для iOS
 * 3. prefers-reduced-motion глобально
 * 4. aspect-ratio fallback
 * 5. Fallback для старих браузерів
 */

/* ============================================================================
   1. SAFE-AREA-INSET CSS Custom Properties для iOS
   ============================================================================ */

:root {
  /* CSS custom properties з fallback для браузерів без підтримки env() */
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
  
  /* Спеціальні значення для безпечних областей */
  --safe-padding: var(--safe-area-left, 0px);
}

/* ============================================================================
   2. STICKY POSITIONING - Безпечна альтернатива position: fixed
   ============================================================================ */

/* 
 * ❌ НІКОЛИ не використовуйте position: fixed - це викликає проблеми на iOS Safari
 * ✅ Використовуйте .ios-safe-sticky замість цього
 */

.ios-safe-sticky {
  position: sticky; /* Safari */
  position: sticky;
  z-index: 100;
  
  /* Забезпечує безпечне позиціонування навколо notch на iOS */
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
  
  /* Fallback для браузерів без підтримки sticky */
  @supports not (position: sticky) {
    position: relative;
    display: flex;
    flex-wrap: wrap;
  }
}

/* Базові варіанти sticky позиціонування */

.sticky-top {
  position: sticky;
  position: sticky;
  top: 0;
  z-index: 100;
}

.sticky-top-safe {
  position: sticky;
  position: sticky;
  top: var(--safe-area-top, 0);
  z-index: 100;
}

/* ============================================================================
   3. PREFERS-REDUCED-MOTION - Глобальна підтримка для доступності
   ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ============================================================================
   4. ASPECT-RATIO FALLBACK для старих браузерів
   ============================================================================ */

.aspect-ratio-16-9 {
  @supports (aspect-ratio: 16/9) {
    aspect-ratio: 16/9;
  }
  
  @supports not (aspect-ratio: 16/9) {
    position: relative;
    padding-top: 56.25%; /* 16:9 */
    
    & > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

.aspect-ratio-4-3 {
  @supports (aspect-ratio: 4/3) {
    aspect-ratio: 4/3;
  }
  
  @supports not (aspect-ratio: 4/3) {
    position: relative;
    padding-top: 75%; /* 4:3 */
    
    & > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

.aspect-ratio-1-1 {
  @supports (aspect-ratio: 1/1) {
    aspect-ratio: 1/1;
  }
  
  @supports not (aspect-ratio: 1/1) {
    position: relative;
    padding-top: 100%; /* 1:1 */
    
    & > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

.aspect-ratio-9-16 {
  @supports (aspect-ratio: 9/16) {
    aspect-ratio: 9/16;
  }
  
  @supports not (aspect-ratio: 9/16) {
    position: relative;
    padding-top: 177.78%; /* 9:16 */
    
    & > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

/* ============================================================================
   5. VIDEO CONTAINER SAFE - Безпечний контейнер для відео з poster
   ============================================================================ */

.video-container {
  position: relative;
  background-color: #000;
  overflow: hidden;
  
  /* Контейнер завжди показує poster пока відео не завантажилось */
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  
  /* Aspect ratio для відео 16:9 */
  @supports (aspect-ratio: 16/9) {
    aspect-ratio: 16/9;
  }
  
  @supports not (aspect-ratio: 16/9) {
    padding-top: 56.25%; /* 16:9 */
  }
}

@supports not (aspect-ratio: 16/9) {
  .video-container video,
  .video-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
}

/* ============================================================================
   6. SAFE PADDING для iOS Notch / Dynamic Island
   ============================================================================ */

.safe-padding-top {
  padding-top: var(--safe-area-top);
}

.safe-padding-bottom {
  padding-bottom: var(--safe-area-bottom);
}

.safe-padding-left {
  padding-left: var(--safe-area-left);
}

.safe-padding-right {
  padding-right: var(--safe-area-right);
}

.safe-padding-horizontal {
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

.safe-padding-all {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

/* ============================================================================
   7. SAFE MARGIN для iOS Notch / Dynamic Island
   ============================================================================ */

.safe-margin-top {
  margin-top: var(--safe-area-top);
}

.safe-margin-bottom {
  margin-bottom: var(--safe-area-bottom);
}

.safe-margin-left {
  margin-left: var(--safe-area-left);
}

.safe-margin-right {
  margin-right: var(--safe-area-right);
}

.safe-margin-horizontal {
  margin-left: var(--safe-area-left);
  margin-right: var(--safe-area-right);
}

/* ============================================================================
   8. FALLBACK ДЛЯ СТАРИХ БРАУЗЕРІВ - CSS Grid Gap
   ============================================================================ */

.grid-with-gap {
  display: grid;
  
  @supports (gap: 1rem) {
    gap: 1rem;
  }
  
  @supports not (gap: 1rem) {
    padding: 0.5rem;
    
    & > * {
      margin: 0.5rem;
    }
  }
}

/* ============================================================================
   9. SMOOTH SCROLLING FALLBACK
   ============================================================================ */

html {
  @supports (scroll-behavior: smooth) {
    scroll-behavior: smooth;
  }
  
  @supports not (scroll-behavior: smooth) {
    scroll-behavior: auto;
  }
}

/* ============================================================================
   10. FLEXBOX GAP FALLBACK
   ============================================================================ */

.flex-with-gap {
  display: flex;
  
  @supports (gap: 1rem) {
    gap: 1rem;
  }
  
  @supports not (gap: 1rem) {
    & > * {
      margin-right: 1rem;
      
      &:last-child {
        margin-right: 0;
      }
    }
  }
}

/* ============================================================================
   11. CSS CONTAINS FALLBACK для Performance
   ============================================================================ */

.contained {
  @supports (contain: layout) {
    contain: layout style paint;
  }
}

/* ============================================================================
   GLOBAL SAFE DEFAULTS
   ============================================================================ */

*,
*::before,
*::after {
  box-sizing: border-box;
}

html {
  width: 100%;
  height: 100%;
  
  /* Виправлення: НЕ додаємо padding на html - це зсуває весь контент */

  /* Safe area буде враховуватись в конкретних компонентах (header, footer, тощо) */
}

body {
  width: 100%;
  min-height: 100%;
  max-width: 100vw; /* Запобігає перевищенню ширини viewport */
  box-sizing: border-box;
  
  /* Запобігає горизонтальному скролу з safe-area */
  overflow-x: hidden;
  
  /* Safe area padding буде застосовуватись у конкретних компонентах */
  padding-left: 0;
  padding-right: 0;
}

/* ====================================================================================
   ACCESSIBLE VISUALLY HIDDEN TEXT
   ============================================================================ */

.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* ============================================================================
   SKIP LINKS для доступності
   ============================================================================ */

.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: #000;
  color: white;
  padding: 8px;
  text-decoration: none;
  z-index: 100;
  
  &:focus {
    top: 0;
  }
}






